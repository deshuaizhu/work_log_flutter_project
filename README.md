# WorkLog - 工作日志记录应用

一个简洁优雅的Windows桌面应用，用于记录和管理每天的工作时间段和内容。

## 功能特性

### 📅 今日工作记录
- **智能时间填充**：添加新记录时，自动使用最后一条记录的结束时间作为开始时间，结束时间自动增加30分钟
- **日期筛选**：支持选择任意日期查看历史记录，快速切换不同日期的工作内容
- **日期标记**：日期选择器中，有工作日志的日期会在左上角显示蓝色圆点标记，方便快速识别
- **一键重置**：快速回到今日视图
- **实时编辑**：支持编辑和删除工作记录，操作简单直观

### 📚 历史记录查询
- **默认日期范围**：默认显示最近一个月的工作记录，方便快速查看近期工作
- **日期范围筛选**：灵活选择开始和结束日期，查看指定时间段的工作记录
- **日期标记**：日期选择器中，有工作日志的日期会在左上角显示蓝色圆点标记，一目了然
- **按日期分组**：自动按日期分组显示，清晰展示每天的工作安排
- **完整操作**：历史记录同样支持编辑和删除功能

### 📤 导出功能
- **默认日期范围**：默认显示最近一个月的工作记录，方便快速导出近期数据
- **Markdown格式**：导出为标准的Markdown文件，便于分享和查看
- **智能标题联动**：导出标题自动根据筛选日期的结束日期生成，格式为 `{年份}年{月份}月Monthly Report`（如：`2025年11月Monthly Report`），随日期筛选自动更新
- **智能文件名联动**：文件名自动根据筛选日期的结束日期和系统用户名生成，格式为 `FMS-{username}-{年份}年{月份}月-monthly report`（如：`FMS-zhudeshuai-2025年11月-monthly report`），随日期筛选自动更新
- **日期范围选择**：支持导出指定日期范围的工作记录，标题和文件名会根据结束日期自动更新
- **手动编辑**：标题和文件名支持手动编辑，可在自动生成的基础上进行个性化调整

### 💾 数据源管理
- **文件路径显示**：实时查看当前使用的数据文件路径
- **自定义数据源**：支持选择已存在的JSON文件作为数据源
- **自动数据同步**：切换数据源后，所有页面（今日、历史）的数据会自动刷新
- **数据验证**：切换数据源时会自动验证文件格式的有效性

### ⚙️ 设置功能
- **黑夜模式切换**：一键切换应用的黑夜模式，支持亮色、暗色和系统模式
- **设置持久化**：主题设置会自动保存，下次启动时自动应用

## 技术架构

### 项目结构
```
lib/
├── main.dart                 # 应用入口和主布局
├── models/
│   └── work_log_entry.dart   # 工作记录数据模型
├── services/
│   ├── storage_service.dart  # JSON文件存储服务
│   └── theme_service.dart     # 主题管理服务
├── controllers/
│   ├── main_controller.dart   # 主控制器
│   ├── today_controller.dart  # 今日页面控制器
│   ├── history_controller.dart # 历史页面控制器
│   ├── export_controller.dart # 导出页面控制器
│   ├── data_source_controller.dart # 数据源页面控制器
│   ├── settings_controller.dart # 设置页面控制器
│   └── work_log_data_controller.dart # 共享数据控制器（管理所有有日志的日期集合）
├── pages/
│   ├── today_page.dart       # 今日页面
│   ├── history_page.dart     # 历史页面
│   ├── export_page.dart      # 导出页面
│   ├── data_source_page.dart # 数据源页面
│   └── settings_page.dart    # 设置页面
└── widgets/
    ├── sidebar.dart          # 左侧导航菜单
    ├── time_range_picker.dart # 时间范围选择器
    ├── custom_date_picker.dart # 自定义日期选择器（支持日期标记）
    └── work_log_item.dart    # 工作记录项组件
```

### 核心技术
- **Flutter 3.3.4+** - 跨平台UI框架
- **GetX** - 状态管理和依赖注入
- **JSON文件存储** - 轻量级本地数据持久化
- **Material Design 3** - 现代化UI设计
- **深色模式支持** - 支持亮色、暗色和系统模式切换
- **共享数据架构** - 使用共享数据 Controller 统一管理跨页面的共享数据，避免数据重复和同步问题
- **组件化设计** - 自定义日期选择器组件，支持日期标记功能，可在多个页面复用

### 主要依赖
- `get` - 状态管理和路由管理
- `path_provider` - 获取应用数据目录
- `file_picker` - 文件选择器（导出和数据源选择）
- `intl` - 国际化日期格式化

## 安装与运行

### 环境要求
- Flutter SDK >= 3.3.4 （当前使用3.19.6）
- Windows 10/11（需要启用开发者模式以支持符号链接）

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd work_log_flutter_project
   ```

2. **安装依赖**
   ```bash
   flutter pub get
   ```

3. **运行应用**
   ```bash
   flutter run -d windows
   ```

### Windows开发者模式设置

如果遇到符号链接错误，需要启用Windows开发者模式：
1. 打开Windows设置（`Win + I`）
2. 搜索"开发者模式"或运行 `start ms-settings:developers`
3. 启用"开发者模式"选项

## 使用说明

### 添加工作记录
1. 在"今日"页面点击"添加记录"按钮
2. 选择时间段（开始时间和结束时间）
3. 输入工作内容
4. 点击"添加"保存

### 编辑记录
- 将鼠标悬停在记录上，点击编辑图标
- 修改时间段或内容后保存

### 查看历史
1. 切换到"历史"页面
2. 页面默认显示最近一个月的工作记录
3. 点击日期范围选择器，可以自定义开始和结束日期
4. 在日期选择器中，有工作日志的日期会在左上角显示蓝色圆点标记
5. 查看按日期分组的工作记录

### 导出记录
1. 切换到"导出"页面
2. 页面默认显示最近一个月的工作记录
3. 选择日期范围（开始日期和结束日期）
4. 系统会自动生成导出标题和文件名：
   - **导出标题**：根据结束日期自动生成，格式为 `{年份}年{月份}月Monthly Report`
   - **文件名**：根据结束日期和系统用户名自动生成，格式为 `FMS-{username}-{年份}年{月份}月-monthly report`
5. （可选）如需自定义，可手动编辑标题或文件名
6. 点击"导出"按钮，选择保存位置即可导出为Markdown文件

**提示**：
- 更改日期范围时，标题和文件名会自动更新，无需手动修改
- 日期选择器中，有工作日志的日期会在左上角显示蓝色圆点标记，方便选择有数据的日期范围

### 管理数据源
1. 切换到"数据源"页面
2. 查看当前使用的数据文件路径
3. 点击"选择文件"按钮，选择已存在的JSON文件
4. 系统会自动验证文件格式并重新加载数据
5. 切换成功后，今日和历史页面的数据会自动刷新

**提示**：只能选择已存在的JSON文件，文件格式必须有效。

### 应用设置
1. 切换到"设置"页面
2. 使用"黑夜模式"开关切换应用主题：
   - **开启**：应用使用暗色主题
   - **关闭**：应用使用亮色主题
3. 设置会自动保存，下次启动时自动应用

**提示**：主题设置会持久化保存，支持在亮色和暗色模式之间切换。

## 数据存储

### 工作记录文件
工作记录以JSON格式存储：
- **默认路径**：Windows: `%APPDATA%\work_log_flutter_project\work_logs.json`
- **自定义路径**：可在"数据源"页面选择自定义JSON文件路径
- **数据格式**：每个记录包含ID、日期、开始时间、结束时间和内容

### 配置文件
应用配置存储在应用数据目录中：
- **配置文件路径**：`%APPDATA%\work_log_flutter_project\config.json`
- **配置内容**：
  - `dataSourcePath`：自定义数据源文件路径（可选）
  - `themeMode`：主题模式（light/dark/system）

## UI设计

- **主色调**：`#136dec`（蓝色）
- **浅色模式背景**：`#f6f7f8`
- **深色模式背景**：`#101822`
- **左侧菜单宽度**：256px
- **响应式布局**：最大宽度896px，居中显示

## 开发计划

- [ ] 数据备份和恢复功能
- [ ] 工作记录统计和分析
- [ ] 多语言支持
- [ ] 数据导入功能
- [ ] 工作记录标签分类

## 许可证

本项目为私有项目，仅供个人使用。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---

**WorkLog** - 让工作记录更简单、更高效 🚀
